# Active Problems Inbox - New Problem Reporting

## üìã Instructions for Reporting Problems

This file is your **direct communication channel** with the LLM for reporting new problems, issues, bugs, or requests.

### How It Works

When you discover an issue or have a request:

1. **Scroll to the bottom** of this file to the section marked "PASTE YOUR PROBLEMS HERE ‚Üì"
2. **Paste your problem description** (can be plain text, structured, or use the template below)
3. **Save this file**
4. **Start a new LLM session** or continue an existing one

The LLM will automatically:
1. ‚úÖ Read this file at session start
2. ‚úÖ Assign a Problem ID (format: `P-YYYY-MM-DD-NNN`)
3. ‚úÖ Add it to `/problems/problems_log.md` as "Active"
4. ‚úÖ Investigate and fix the problem
5. ‚úÖ Remove the fixed portion from this file
6. ‚úÖ Document the fix in `/progress/fixed_issues_log.md`
7. ‚úÖ Update all relevant documentation

---

## üìù Problem Reporting Template (Optional - Use if Helpful)

You can use this structured template or just paste plain text below. Both work!

```markdown
## Problem: [Short descriptive title]
**Reported**: YYYY-MM-DD HH:MM
**Severity**: [CRITICAL / HIGH / MEDIUM / LOW]
**Component**: [Which part of the system - e.g., Dashboard, API, Auth, etc.]
**Reporter**: [Your name or "User"]

**Description**:
[Detailed description of what's wrong - be as specific as possible]

**Steps to Reproduce**:
1. [First step]
2. [Second step]
3. [Third step - where problem occurs]

**Expected Behavior**:
[What should happen]

**Actual Behavior**:
[What actually happens - include error messages if any]

**Additional Context**:
- Error messages (copy/paste exact text)
- Screenshots (describe or reference)
- Logs or stack traces
- Browser/environment details
- Any other relevant information

---
```

---

## üö® Severity Guidelines

Use these guidelines to determine severity level:

### CRITICAL ‚ö†Ô∏è
- **Security vulnerabilities** (data exposure, authentication bypass, XSS, SQL injection)
- **Data loss or corruption** (user data deleted, database inconsistency)
- **Complete system failure** (app won't start, total crash, 500 errors)
- **Authentication broken** (can't log in, unauthorized access)
- **Database connection failures** (can't connect to DB)
- **Payment/billing issues** (incorrect charges, failed payments)

### HIGH üî¥
- **Major features completely broken** (can't connect AWS account, discovery fails)
- **Severe user experience degradation** (extremely slow, constant errors)
- **Data inconsistency** (wrong data displayed, calculations incorrect)
- **Performance severely degraded** (page takes >30 seconds to load)
- **Critical workflow blocked** (can't complete essential task)

### MEDIUM üü°
- **Feature partially broken** (works sometimes, inconsistent behavior)
- **Workaround available** but inconvenient (can achieve goal via alternate method)
- **UI/UX issues** affecting usability (confusing interface, poor layout)
- **Minor data inconsistencies** (stale data, minor calculation errors)
- **Performance issues** (slow but usable, 5-10 second delays)

### LOW üü¢
- **Cosmetic issues** (styling problems, alignment issues, typos)
- **Minor inconveniences** (extra clicks needed, suboptimal flow)
- **Nice-to-have improvements** (feature requests, enhancements)
- **Documentation errors** (outdated docs, missing examples)
- **Edge case bugs** (rarely occurs, specific conditions)

---

## üí° Example Problem Report (For Reference)

This is an example of a well-formatted problem report:

```markdown
## Problem: Dashboard shows $0 cost after connecting AWS account
**Reported**: 2025-12-25 10:30
**Severity**: HIGH
**Component**: Dashboard / Metrics
**Reporter**: User

**Description**:
After connecting a new AWS account via CloudFormation method and successfully
completing resource discovery (status shows 'active'), the dashboard displays
"$0 Cost", "0% Usage", and shows no metrics or resource data. Expected to see
actual AWS usage and cost data immediately after discovery completes.

**Steps to Reproduce**:
1. Log in to platform as client user
2. Navigate to "Connect AWS Account"
3. Select CloudFormation method
4. Deploy stack in AWS Console
5. Verify connection (status becomes 'connected')
6. Wait for discovery to complete (status becomes 'active')
7. Navigate to /client dashboard
8. Observe all metrics show zero/empty

**Expected Behavior**:
Dashboard should immediately display:
- Current month cost (e.g., "$45.67")
- CPU/memory usage percentages (e.g., "23% CPU")
- Instance count (e.g., "5 instances")
- Resource utilization charts with data
- Spot vs On-Demand breakdown

**Actual Behavior**:
Dashboard displays:
- Cost: "$0.00"
- Usage: "0% CPU, 0% Memory"
- Instances: "No instances found"
- All charts are empty
- No resource data visible

Data DOES appear after midnight when the scheduled cron job runs, indicating
the health check system is not being triggered immediately after discovery.

**Additional Context**:
- Discovery worker completes successfully (logs show "Discovery completed")
- Instances ARE created in database (verified via SQL query)
- account.status transitions correctly: pending ‚Üí connected ‚Üí active
- No JavaScript errors in browser console
- Issue occurs consistently on fresh account connections
- Workaround: Wait until midnight OR manually trigger health checks
- Browser: Chrome 120, Firefox 121 (both affected)
- Environment: Production

**Suspected Root Cause**:
Health checks may only run on scheduled cron (midnight), not immediately
after discovery completion. Need to trigger component_health_checks()
right after discovery_worker finishes.
```

---

## ‚úÖ Tips for Effective Problem Reports

1. **Be Specific**:
   - ‚úÖ "DELETE /client/accounts/123 returns HTTP 204 causing JSON parse error"
   - ‚ùå "Delete doesn't work"

2. **Include Context**:
   - Browser and version (Chrome 120, Firefox 121, Safari 17)
   - User role (Admin, Client, Lab user)
   - Account state (fresh connection, existing account, specific AWS region)
   - Timestamp when issue occurred

3. **One Problem Per Report**:
   - Don't combine "Dashboard is slow AND delete button is broken"
   - Submit separate reports for separate issues

4. **Check Existing Issues First**:
   - Look in `/problems/problems_log.md` to see if already reported
   - Check `/progress/fixed_issues_log.md` to see if already fixed

5. **Be Honest About Severity**:
   - Don't mark everything as CRITICAL
   - Use the severity guidelines above
   - LLM will prioritize accordingly

6. **Plain Text is Fine**:
   - Don't worry about perfect formatting
   - Just describe the problem clearly
   - Template is optional, not required

---

## üìö Related Documentation

- **Problem Log**: `/problems/problems_log.md` - All problems (active & fixed)
- **Fixed Issues**: `/progress/fixed_issues_log.md` - Detailed fix documentation
- **Bug Fix Protocol**: `/instructions/fix_protocol.md` - How LLM handles fixes
- **Master Rules**: `/instructions/master_rules.md` - LLM workflow

---

## üîç Recently Fixed Problems (Reference)

These problems were reported here and have been fixed:

### ‚úÖ P-2025-12-25-003: DELETE endpoint HTTP 204 error
**Fixed**: 2025-12-25
**Summary**: DELETE /client/accounts/{id} returned HTTP 204 (No Content) without
response body, causing frontend JSON parsing errors. Fixed by explicitly setting
status_code=200 with success message body.
**File**: backend/api/client_routes.py:84-143

### ‚úÖ P-2025-12-25-002: Dashboard zero data after fresh connection
**Fixed**: 2025-12-25
**Summary**: Dashboard showed $0 and no metrics immediately after account connection.
Fixed by triggering component_health_checks() immediately after discovery_worker
completion instead of waiting for midnight cron.
**File**: backend/workers/discovery_worker.py:334-340

### ‚úÖ P-2025-12-25-001: AWS account takeover vulnerability
**Fixed**: 2025-12-25
**Summary**: CloudFormation onboarding flow lacked global account_id uniqueness check,
allowing one AWS account to be connected to multiple users. Fixed by adding uniqueness
validation before account creation.
**File**: backend/api/onboarding_routes.py:495

---

## üéØ Current Active Problems

**Status**: ‚úÖ No active problems currently (all known issues resolved as of 2025-12-25)

Remaining problems will appear here after you paste them below.

---
---
---

# ‚¨áÔ∏è PASTE YOUR PROBLEMS HERE ‚¨áÔ∏è

## Instructions:
- Paste your problem description below this line
- Can be plain text, bullet points, or use the template above
- Multiple problems? Add them one after another, separated by "---"
- Don't worry about formatting - just describe the issue clearly
- Save this file when done

---

## Your Problem(s) - Add Below This Line:

## INVESTIGATION COMPLETE (2025-12-26) - Session 2

**Status**: 3 problems investigated, 1 FIXED, 2 NOT CODE BUGS

### Investigation Results:

**P-2025-12-26-001: "Zombie Database" (Schema Drift)** ‚ö†Ô∏è ENVIRONMENT ISSUE
- **Investigation**: Reviewed database models.py - schema definition is **CORRECT**
- **Columns exist**: connection_method (line 81), aws_access_key_id (line 89), aws_secret_access_key (line 90)
- **Root cause**: User's local Docker database volume has outdated schema
- **Resolution**: User needs to drop/recreate database OR run migrations
- **Code change**: NONE - this is an environment/deployment issue
- **Reference**: `/problems/problems_log.md#P-2025-12-26-001`

**P-2025-12-26-002: "Partial Commit Bug"** ‚ùå NOT A BUG
- **Investigation**: Reviewed admin.py:722-745
- **Finding**: Code has SINGLE commit at line 745 for both User and Account
- **Structure**: `db.add(user)` ‚Üí `db.flush()` ‚Üí `db.add(account)` ‚Üí `db.commit()`
- **This is CORRECT**: flush() generates ID without committing, final commit saves both atomically
- **If failures occur**: They're due to P-2025-12-26-001 (schema drift) causing entire transaction to fail
- **Code change**: NONE - implementation is correct
- **Reference**: `/problems/problems_log.md#P-2025-12-26-002`

**P-2025-12-26-003: "Status Filter Mismatch"** ‚úÖ FIXED
- **Investigation**: Reviewed client_routes.py:52-55
- **Bug confirmed**: GET /client/accounts filtered by `status.in_(["connected", "active", "warning"])`
- **Problem**: Admin creates placeholder accounts with status="pending" (admin.py:737)
- **Impact**: Pending accounts hidden from user, frontend shows onboarding form
- **Fix applied**: Removed status filter - now returns ALL accounts for user
- **Code changed**: `backend/api/client_routes.py:46-56`
- **Reference**: `/progress/fixed_issues_log.md#P-2025-12-26-003`

### Summary:
- **1 REAL BUG** - Status filter fixed
- **2 NOT BUGS** - Schema drift (environment) and partial commit (code is correct)

---

---

## INVESTIGATION COMPLETE (2025-12-26) - Session 3

**Status**: 3 interconnected problems FIXED

### Investigation Results:

**P-2025-12-26-006: Login Loop - AuthGateway Endpoint** ‚úÖ FIXED
- **Problem**: AuthGateway calling `/client/accounts` instead of `/v1/client/accounts`
- **Impact**: 404 errors, login loop after successful connection
- **Fix**: Updated endpoint path in AuthGateway.jsx:13
- **File**: `frontend/src/components/AuthGateway.jsx`
- **Reference**: `/progress/fixed_issues_log.md#P-2025-12-26-006`

**P-2025-12-26-005: TypeError: de.get is not a function** ‚úÖ FIXED
- **Problem**: API client lacked axios-style `.get()`, `.post()`, `.delete()` methods
- **Impact**: JavaScript crashes when components called `api.get()`
- **Fix**: Rewrote api.js with ApiClient class providing axios interface
- **File**: `frontend/src/services/api.js` (complete rewrite)
- **Reference**: `/progress/fixed_issues_log.md#P-2025-12-26-005`

**P-2025-12-26-004: Multiple Conflicting API Files** ‚úÖ FIXED
- **Problem**: 4 API files existed (api.js, api.jsx, apiClient.jsx, config/api.jsx)
- **Impact**: Bundler randomly picked wrong file, inconsistent behavior
- **Fix**: Deleted api.jsx and apiClient.jsx, kept only api.js
- **Files Deleted**: `api.jsx`, `apiClient.jsx`
- **Reference**: `/progress/fixed_issues_log.md#P-2025-12-26-004`

### Backend Issue Status:

**Note**: The backend status filter issue mentioned in the problem report was already fixed in P-2025-12-26-003 (previous session). GET `/client/accounts` now returns ALL accounts regardless of status.

---

**Note**: No new problems currently pending. Add new problems below this line.

---

## INVESTIGATION COMPLETE (2025-12-26) - Session 4

**Status**: 1 problem FIXED

### Investigation Results:

**P-2025-12-26-007: Missing API Methods - Model Upload Broken** ‚úÖ FIXED
- **Problem**: Console errors showing `TypeError: ue.getModels/uploadModel/getSystemOverview is not a function`
- **Root Cause**: ApiClient class lacked specialized methods for model operations and system monitoring
- **Impact**: Model upload completely broken, system monitoring broken, Lab Mode features broken
- **Fix**: Added 9 specialized methods to ApiClient class
- **Methods Added**:
  - `getModels()` ‚Üí `/v1/ai/list`
  - `uploadModel(formData)` ‚Üí `/v1/ai/upload` (with proper multipart/form-data handling)
  - `acceptModel()`, `graduateModel()`, `enableModel()`, `activateModel()`, `rejectModel()`
  - `getSystemOverview()` ‚Üí `/v1/admin/health/overview`
  - `getComponentLogs()`
- **File**: `frontend/src/services/api.js`
- **Reference**: `/progress/fixed_issues_log.md#P-2025-12-26-007`

### Console Errors Resolved:
```
‚úÖ FIXED: TypeError: ue.getSystemOverview is not a function
‚úÖ FIXED: TypeError: ue.getModels is not a function
‚úÖ FIXED: TypeError: ue.uploadModel is not a function
```

---

**Note**: No new problems currently pending. Add new problems below this line.
We need to update our file (scenario-based-full-application-info.md) because it doesn‚Äôt show the cluster management using or ML mode.  We use our ML model,
and for what we‚Äôre doing, refer to our training script (family_stress_model.py). We also use different filtering components like a web scraper. Then we take 
our top five cheap and stable pools and use spot switching strategy on either ML model or, in the worst case, rebalance and terminate the notice from AWS. 
We also have a feature that allows us to monitor these notices across all clients. If any client receives a rebalance notice, we‚Äôll check all clients from those pools, 
even if our model suggests it or if they‚Äôve already received the notice.  Add this to the file and refer to all the scenarios. 
Then fix each and every divide in stages and start implementing. LLM instructions should be as follows: 
it will complete stage-wise detailed fixes and then automatically start with stage-to-detailed fixes.
It won‚Äôt only fix the problem but also check if the front end is supported, other components‚Äô functions, 
and schema is supporting, and fix them too if by fixing those issues, there‚Äôs any new issue brought.
aslo  Critical Errors (System Will Crash or Fail to Build)
backend/requirements.txt: File is EMPTY. Backend will fail to install dependencies (FastAPI, SQLAlchemy, boto3, etc.).

backend/pipelines/standalone_optimizer.py: Import error from flask import jsonify. This file uses Flask logic in a FastAPI project.

backend/api/client_routes.py: HTTP Protocol Violation. Function delete_account uses status_code=204 but returns a JSON body. (204 must be empty).

frontend/src/services/api.js: Missing Methods. Components call api.uploadModel and api.getModels, but this file only exports raw Axios methods (get, post).

frontend/src/services/api.jsx: File Conflict. Duplicate API service file that confuses the React bundler.

frontend/src/services/apiClient.jsx: File Conflict. Another duplicate API service file.

backend/api/onboarding_routes.py: Logic Bug. connect_via_credentials raises 409 Conflict even if the user is trying to update their own account.

backend/api/ai_routes.py: Pydantic Warning. ModelMetadata needs model_config = ConfigDict(protected_namespaces=()) to avoid model_ prefix warnings.

üü† Functional Logic Errors (Features Won't Work)
backend/api/admin.py: Orphan User Bug. create_user_by_admin creates a User but fails to create a pending Account row, causing the Client Dashboard to crash (null error).

backend/workers/discovery_worker.py: Delayed Data. The scan_account function does not trigger HealthMonitor or CostEstimator immediately, leaving the dashboard empty until midnight.

backend/api/client_routes.py: Visibility Bug. get_connected_accounts likely filters by status='active', hiding newly connected accounts (status='connected') from the frontend list.

frontend/src/components/ClientSetup.jsx: UX Loop. Defaults to showing the "Add Account" form instead of checking GET /accounts first, making users think connection failed.

frontend/src/layouts/DashboardLayout.jsx: Crash Risk. Does not handle res.data.status === 'no_account' gracefully, leading to a White Screen of Death for new users.

üü° Infrastructure & Security Gaps
backend/utils/crypto.py: Insecure Default. Likely uses a hardcoded key or fails if ENCRYPTION_KEY env var is missing.

docker-compose.yml: Missing Config. Does not inject ENCRYPTION_KEY into the backend container.

backend/database/models.py: Schema Drift. The code has aws_access_key_id, but the running Postgres volume likely uses an old schema (requires volume deletion).

ecurity & Configuration Gaps
backend/main.py: Insecure CORS. allow_origins=["*"] allows any website to access your API; restrict this to your frontend domain in production.

backend/config.py: Weak JWT Secret. The SECRET_KEY likely defaults to a hardcoded string if the .env variable is missing, allowing attackers to forge tokens.

frontend/nginx.conf: Missing Security Headers. Nginx config lacks X-Frame-Options, Content-Security-Policy, and X-XSS-Protection headers.

backend/api/auth.py: No Rate Limiting. Login endpoints lack rate limiting, making them vulnerable to Brute Force attacks.

üìâ Performance & Scalability Issues
backend/api/metrics_routes.py: N+1 Query Problem. The get_metrics endpoint likely loops through instances performing a DB query inside the loop instead of using a JOIN.

frontend/src/components/NodeFleet.jsx: No Pagination. Tries to render all instances at once; if a client has 500+ nodes, the browser will freeze.

backend/scraper/fetch_static_data.py: Memory Leak Risk. Loads the entire AWS Spot JSON (hundreds of MBs) into RAM every time instead of streaming or processing in chunks.

backend/websocket/manager.py: Connection Leak. The disconnect method might not handle ungraceful disconnects (e.g., closed tab) correctly, leaving "zombie" connections in the active list.

üêõ Logic & Data Integrity
backend/utils/aws_session.py: Region Locking. Logic often defaults strictly to us-east-1, ignoring the region specified in the User's Account settings.

backend/workers/optimizer_task.py: Race Condition. If two optimization tasks run simultaneously for the same cluster, they might try to terminate the same node twice.

backend/api/waste_routes.py: Mock Data. This file likely contains hardcoded "Demo" return values rather than actual logic to scan EBS volumes.

backend/database/models.py: Missing Indexes. The instances table lacks an index on account_id, making dashboard queries slow as data grows.

üëÅÔ∏è Frontend UX/UI Polish
frontend/src/components/Lab/DragDropUpload.jsx: No Client-Side Validation. Fails to check file size or type before upload, wasting bandwidth on invalid files.

frontend/src/services/api.js: Hardcoded Localhost. The fallback http://localhost:8000 will break if you access the frontend from a different device on the network (should use window.location.hostname).

frontend/src/App.jsx: Missing 404 Page. If a user navigates to a non-existent route, they see a blank screen instead of a "Page Not Found" component.

üßπ Code Quality & Best Practices
backend/utils/system_logger.py: Synchronous Logging. Writing to the database for every log entry (logger.info) inside async routes will block the event loop and degrade API throughput.

backend/Dockerfile: Root User Execution. The container runs as root; best practice is to create a non-root user (e.g., appuser) for security.

backend/pipelines/__init__.py: Unused Imports. Likely imports classes that are never exposed, increasing memory usage slightly.
Here is the detailed, line-by-line breakdown of every problem, categorized by how they break the interaction between your functions and code components.

### üîó **Interaction Failure: Frontend Service <-> UI Components**

* **1. Missing Service Methods:** `frontend/src/services/api.js` exports a raw Axios instance, but `frontend/src/components/Lab/ModelGovernance.jsx` tries to call `.getModels()` and `.uploadModel()`, causing a `TypeError: is not a function` crash.
* **2. File Conflict:** `frontend/src/services/api.jsx` and `frontend/src/services/apiClient.jsx` exist alongside `api.js`; the bundler imports the wrong (likely empty) file, breaking all API calls in `App.jsx`.
* **3. Localhost Hardcoding:** `frontend/src/services/api.js` falls back to `http://localhost:8000`, which breaks communication when accessing the frontend from a different machine or Docker network (should use relative `/api` path or env var).

### üîó **Interaction Failure: Admin Creation <-> Client Dashboard**

* **4. The "Orphan" User:** `backend/api/admin.py` (`create_user_by_admin`) inserts a `User` row but fails to call the `Account` model to create a placeholder row.
* **5. Dashboard Crash:** `backend/api/client_routes.py` (`get_dashboard_stats`) queries for an `Account` using the user's ID, finds `None`, and returns 404 or null.
* **6. Unhandled Null State:** `frontend/src/layouts/DashboardLayout.jsx` receives the null/404 response and attempts to read `data.stats.total_instances`, causing a "White Screen of Death".

### üîó **Interaction Failure: Cloud Connect <-> Background Workers**

* **7. Connection Loop:** `backend/api/client_routes.py` (`get_connected_accounts`) filters queries by `.filter(status='active')`, so it hides accounts that are just `'connected'`, causing `ClientSetup.jsx` to think no account exists and show the form again.
* **8. Empty Dashboard Data:** `backend/workers/discovery_worker.py` (`scan_account`) saves instances to the DB but fails to chain-call `HealthMonitor.check_usage(account_id)`, resulting in "0% CPU" and "No Data" on the dashboard until the midnight cron job runs.
* **9. Duplicate Key Crash:** `backend/api/onboarding_routes.py` (`connect_via_credentials`) tries to `INSERT` a new Account row instead of updating the existing `pending` row created during signup, causing a `UniqueViolation` database error.

### üîó **Interaction Failure: Backend Code <-> Runtime Environment**

* **10. Legacy Framework Error:** `backend/pipelines/standalone_optimizer.py` imports `flask` and `jsonify`, which are not installed in your FastAPI `backend/requirements.txt`, causing the entire backend to crash on startup.
* **11. HTTP Protocol Violation:** `backend/api/client_routes.py` (`delete_account`) sets `status_code=204` (No Content) but returns a JSON body, causing the Frontend's Axios interceptor to throw a `Network Error` even on success.
* **12. Schema Drift:** `backend/database/models.py` defines new columns like `aws_access_key_id`, but the persistent Docker volume (`postgres_data`) retains the old table structure, causing `ProgrammingError: column does not exist` on writes.
* **13. Dependency Mismatch:** `backend/requirements.txt` likely uses a version of `passlib` incompatible with `bcrypt` (v4.0.1+), causing `AttributeError: module 'bcrypt' has no attribute '__about__'` during startup.

### üîó **Interaction Failure: Data Models <-> Validation**

* **14. Pydantic Namespace Conflict:** `backend/api/ai_routes.py` uses a Pydantic model with fields starting with `model_` (e.g., `model_version`), which conflicts with Pydantic V2 protected namespaces unless `model_config = ConfigDict(protected_namespaces=())` is added.
* **15. Missing Enum Handling:** `backend/database/models.py` uses a string for `connection_method`, but `backend/api/onboarding_routes.py` might try to pass a Pydantic Enum object directly to SQLAlchemy, causing a serialization error.
After fixing the "Crash" level errors (Syntax, Imports, Schema, API Definitions), you will likely face **"Runtime & Logic"** errors. These are silent killers that don't stop the server from starting but cause features to fail when used.

Here is the forecast of the **Next 6 Problems** you will encounter:

### 1. The "Missing Brain" Error (ML Model Artifacts)

**Scenario:** You start the backend, it runs, but when you click "Get Prediction" or "Optimize", it crashes.

* **The Error:** `FileNotFoundError: No such file or directory: 'ml_models/mumbai_price_predictor.pkl'`
* **Why:** Your git repository contains the *code* to define the model (`mumbai_price_predictor.py`), but it likely does **not** contain the trained `.pkl` or `.h5` files because they are usually git-ignored.
* **Fix:** You must add a check during startup to see if the model exists. If not, trigger a "Training Mode" or download a default model.

### 2. The "Docker Prison" Error (Kubernetes Connectivity)

**Scenario:** You try to connect a Kubernetes cluster for optimization.

* **The Error:** `kubernetes.config.config_exception.ConfigException: Invalid kube-config file. No configuration found.`
* **Why:** Your backend runs inside a Docker container. It **cannot see** the `~/.kube/config` file on your Mac/Host machine unless you explicitly mount it.
* **Fix:** Update `docker-compose.yml` to map the volume:
```yaml
volumes:
  - ~/.kube:/root/.kube:ro

```



### 3. The "AWS Hammer" Error (Rate Limiting)

**Scenario:** You add an AWS account with 500+ instances. The dashboard loads, then freezes, then shows errors.

* **The Error:** `botocore.exceptions.ClientError: An error occurred (RequestLimitExceeded) when calling the DescribeInstances operation.`
* **Why:** Your `discovery_worker.py` loops through regions. If it runs too fast using `boto3` without backoff strategies, AWS will temporarily block your IP/Key.
* **Fix:** Implement `boto3` config with `max_attempts` and adaptive retry mode in `utils/aws_session.py`.

### 4. The "Zombie Job" Error (Redis Persistence)

**Scenario:** You start a long "Scan" task. You restart the Docker container to fix a bug. The scan never finishes.

* **The Error:** The Dashboard stays stuck on "Scanning..." forever.
* **Why:** Redis (by default in many Docker images) keeps data in RAM. When you restart `docker-compose`, the Job Queue is wiped, but the Postgres database still says `status='scanning'`.
* **Fix:** Configure Redis in `docker-compose.yml` to use a persistent volume (`redis-data`) and implement a "Startup Cleanup" in Python that resets all `'scanning'` accounts to `'failed'` or `'active'`.

### 5. The "CORS Wall" (Production Connection)

**Scenario:** It works on `localhost`, but when you deploy to a server (e.g., EC2) and access via IP, the login fails.

* **The Error:** `Access to fetch at 'http://localhost:8000/...' from origin 'http://54.x.x.x' has been blocked by CORS policy.`
* **Why:** Your `api.js` falls back to `localhost` if `VITE_API_URL` isn't set, and your Backend `main.py` might strictly check origins.
* **Fix:** Ensure `VITE_API_URL` is set in the Docker build process for the frontend, and `main.py` reads `ALLOWED_ORIGINS` from env.

### 6. The "Time Travel" Bug (Timezones)

**Scenario:** You look at the "Savings Graph". The data points look weird or appear in the future/past.

* **The Error:** No error, just wrong data.
* **Why:** Your Backend saves data in UTC (`datetime.utcnow()`), but your Frontend might display it in Local Time without conversion, or vice-versa. Or worse, the Database uses `TIMESTAMP without time zone`.
* **Fix:** Enforce `TIMESTAMP WITH TIME ZONE` in Postgres and use ISO format strictly in API JSON responses.

---

### How to Pre-empt These?

**Don't wait for them to happen.**

1. **Mount Kubeconfig** in Docker Compose now.
2. **Add a "Startup Check"** in `main.py` that prints: "Checking for ML Models... [Found/Missing]".
3. **Check `aws_session.py**` to ensure it has retry logic.
_Last Updated: 2025-12-26_
_This file is actively monitored by the LLM at every session start_
_The LLM will process problems from the "PASTE YOUR PROBLEMS HERE" section_
